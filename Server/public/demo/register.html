<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="../assets/vendors/nprogress/nprogress.js"></script>
</head>
</head>
<body>
    <script>NProgress.start()</script>
    <div id = "component">
        <form id='userForm'>
            <p><input name='UserName' type='text' placeholder="UserName" value='Username'/></p>
            <p><input name='Email' type='text' placeholder="Email" value='425786225@qq.com'/></p>
            <p><input name='City' type='text' placeholder="City" value='Tokyo'/></p>
            <p><input name='Country' type='text' placeholder="Country" value='China'/></p>
            <p><input name='Membership' type='text' placeholder="Membership" value='2'/></p>
            <p><input name='Password' type='text' placeholder="Password" value='Password'/></p>
            <p><input name='UserLevel' type='text' placeholder="UserLevel" value='6'/></p>
            <p><input name='UserExperience' type='text' placeholder="UserExperience" value='12345'/></p> -->
            <p><input name='ProfilePhoto' type='file' value="choose a file" id = "file"/></p>   
            <p>
                <input value='button' type='button' id='btn'/>
            </p>    
            <input name='PhotoPath' type="hidden" id = 'hiddenAvatar' value='http:\\localhost:3000\\demo\\register.html'/>
        </form> 
    </div>    
<script src="../assets/vendors/jquery/jquery.js"></script>
<script type="text/javascript">
    
    $("#btn").on('click', function(){
        //var formData = new FormData($("#userForm")[0])
        
        console.log($("#userForm"))
        var data = serializeObject($("#userForm"))
        
        $.ajax({
            type:'post',
            url:'/front-end/login/users',
            data:JSON.stringify(data),
            processData:false,
            contentType:'application/json',
            success:function(response){
                console.log(response)
            }
        })
    })

    $("#file").on('change',function(){
        var formData = new FormData();
        formData.append('avatar',this.files[0])
        console.log(this.files)

        $.ajax({
            type:'post',
            url:'/front-end/login/upload',
            data:formData,
            processData:false,
            contentType:false,
            success:function(response){
               console.log(response)
               $('#hiddenAvatar').val(response.path)
            }

        })
    })

    function serializeObject(obj){
        //[{name:'username',value:'user input'}]
        //serializeArray
        var result = {}
        var params = obj.serializeArray();
        $.each(params,function(index,value){
            result[value.name] = value.value
        })
        
        return result
    }


</script>
</body>
</html>